OL_list = c()
masterlist = c()
for (each_outlier_row in 1:nrow(summ)){
this_weight <- summ[each_outlier_row, "Animal_ID"]
this_DV  <- summ[each_outlier_row, DV]
OL_list <- c(OL_list, (which(ldr4_cages$Animal_ID == this_weight & ldr4_cages[DV] == this_DV)))
}
print(OL_list)
#Assign list of outliers to specified variable lists (OL_list_EE_kJH, RQ, VO2, VCO2, mgH2O)
assign(paste("OL_list_", DV, sep = ""), OL_list)
}
masterlist <- c(OL_list_EE_kJH, OL_list_RQ, OL_list_VO2, OL_list_VCO2, OL_list_H2Omg, OL_list_Activity)
masterlist_noDup <- unique(masterlist)
lowfat_dehydration_noOL_rep4 <- ldr4_cages[-c(masterlist_noDup),]
################### ldr5
############# subset temp data
target <- c(1,2,3,4,5,6,7)
ldr5_temps_select <- ldr5_temps %>%
filter(AntennaID %in% target)
ldr5_temps <- ldr5_temps_select
#make activity data non-cumulative
ldr5 <- ldr5 %>%
add_column(MOD_ADX = ldr5_act$MOD_ADX) %>%
mutate(Activity = MOD_ADX - lag(MOD_ADX, default = 0))
#subset out baseline data
baseline <- c(7)
baseline_cage <- ldr5 %>%
filter(Animal %in% baseline)
#subset out animal data
target <- c(0,1,2,3,4,5,6)
cages <- ldr5 %>%
filter(Animal %in% target)
cages <- cages %>%
dplyr::select(Animal_ID, sex, DateTime, date, time, weight, Activity, EE_KCalH, EE_kJH, H2Omg,
H2Oml, Deg_C, CO2, VO2, VCO2, RQ, SD_VO2, SD_VCO2, SD_H2Oml,
SD_H2Omg, SS4_FR, H2O_WVP, BP)
ldr5_cages <- cages
count = 1
dependent_variables = c("EE_kJH", "RQ", "VO2", "VCO2", "H2Omg", "Activity")
varname_list = c("EE_OLs","RQ_OLs","VO2_OLs","VCO2_OLs","H2O_OLs", "Activity_OLs")
for (DV in dependent_variables){
print(DV)
model <- lm(as.formula(paste0(DV, " ~ Animal_ID")), data = ldr5_cages)
model.metrics <- augment(model) %>% dplyr::select(-.hat, -.sigma, -.fitted)
summ <- model.metrics %>% filter(abs(.std.resid) > 2) %>% as.data.frame()
OL_list = c()
masterlist = c()
for (each_outlier_row in 1:nrow(summ)){
this_weight <- summ[each_outlier_row, "Animal_ID"]
this_DV  <- summ[each_outlier_row, DV]
OL_list <- c(OL_list, (which(ldr5_cages$Animal_ID == this_weight & ldr5_cages[DV] == this_DV)))
}
print(OL_list)
#Assign list of outliers to specified variable lists (OL_list_EE_kJH, RQ, VO2, VCO2, mgH2O)
assign(paste("OL_list_", DV, sep = ""), OL_list)
}
masterlist <- c(OL_list_EE_kJH, OL_list_RQ, OL_list_VO2, OL_list_VCO2, OL_list_H2Omg, OL_list_Activity)
masterlist_noDup <- unique(masterlist)
lowfat_dehydration_noOL_rep5 <- ldr5_cages[-c(masterlist_noDup),]
################### ldr6
############# subset temp data
target <- c(1,2,3,4,5,7)
ldr6_temps_select <- ldr6_temps %>%
filter(AntennaID %in% target)
ldr6_temps <- ldr6_temps_select
#make activity data non-cumulative
ldr6 <- ldr6 %>%
add_column(MOD_ADX = ldr6_act$MOD_ADX) %>%
mutate(Activity = MOD_ADX - lag(MOD_ADX, default = 0))
#subset out baseline data
baseline <- c(7)
baseline_cage <- ldr6 %>%
filter(Animal %in% baseline)
#subset out animal data
target <- c(0,1,2,3,4,5,6)
cages <- ldr6 %>%
filter(Animal %in% target)
cages <- cages %>%
dplyr::select(Animal_ID, sex, DateTime, date, time, weight, Activity, EE_KCalH, EE_kJH, H2Omg,
H2Oml, Deg_C, CO2, VO2, VCO2, RQ, SD_VO2, SD_VCO2, SD_H2Oml,
SD_H2Omg, SS4_FR, H2O_WVP, BP)
ldr6_cages <- cages
count = 1
dependent_variables = c("EE_kJH", "RQ", "VO2", "VCO2", "H2Omg", "Activity")
varname_list = c("EE_OLs","RQ_OLs","VO2_OLs","VCO2_OLs","H2O_OLs", "Activity_OLs")
for (DV in dependent_variables){
print(DV)
model <- lm(as.formula(paste0(DV, " ~ Animal_ID")), data = ldr6_cages)
model.metrics <- augment(model) %>% dplyr::select(-.hat, -.sigma, -.fitted)
summ <- model.metrics %>% filter(abs(.std.resid) > 2) %>% as.data.frame()
OL_list = c()
masterlist = c()
for (each_outlier_row in 1:nrow(summ)){
this_weight <- summ[each_outlier_row, "Animal_ID"]
this_DV  <- summ[each_outlier_row, DV]
OL_list <- c(OL_list, (which(ldr6_cages$Animal_ID == this_weight & ldr6_cages[DV] == this_DV)))
}
print(OL_list)
#Assign list of outliers to specified variable lists (OL_list_EE_kJH, RQ, VO2, VCO2, mgH2O)
assign(paste("OL_list_", DV, sep = ""), OL_list)
}
masterlist <- c(OL_list_EE_kJH, OL_list_RQ, OL_list_VO2, OL_list_VCO2, OL_list_H2Omg, OL_list_Activity)
masterlist_noDup <- unique(masterlist)
lowfat_dehydration_noOL_rep6 <- ldr6_cages[-c(masterlist_noDup),]
################### ldr7
############# subset temp data
target <- c(1,4,5,6,7)
ldr7_temps_select <- ldr7_temps %>%
filter(AntennaID %in% target)
ldr7_temps <- ldr7_temps_select
#make activity data non-cumulative
ldr7 <- ldr7 %>%
add_column(MOD_ADX = ldr7_act$MOD_ADX) %>%
mutate(Activity = MOD_ADX - lag(MOD_ADX, default = 0))
#subset out baseline data
baseline <- c(7)
baseline_cage <- ldr7 %>%
filter(Animal %in% baseline)
#subset out animal data
target <- c(0,1,2,3,4,5,6)
cages <- ldr7 %>%
filter(Animal %in% target)
cages <- cages %>%
dplyr::select(Animal_ID, sex, DateTime, date, time, weight, Activity, EE_KCalH, EE_kJH, H2Omg,
H2Oml, Deg_C, CO2, VO2, VCO2, RQ, SD_VO2, SD_VCO2, SD_H2Oml,
SD_H2Omg, SS4_FR, H2O_WVP, BP)
ldr7_cages <- cages
count = 1
dependent_variables = c("EE_kJH", "RQ", "VO2", "VCO2", "H2Omg", "Activity")
varname_list = c("EE_OLs","RQ_OLs","VO2_OLs","VCO2_OLs","H2O_OLs", "Activity_OLs")
for (DV in dependent_variables){
print(DV)
model <- lm(as.formula(paste0(DV, " ~ Animal_ID")), data = ldr7_cages)
model.metrics <- augment(model) %>% dplyr::select(-.hat, -.sigma, -.fitted)
summ <- model.metrics %>% filter(abs(.std.resid) > 2) %>% as.data.frame()
OL_list = c()
masterlist = c()
for (each_outlier_row in 1:nrow(summ)){
this_weight <- summ[each_outlier_row, "Animal_ID"]
this_DV  <- summ[each_outlier_row, DV]
OL_list <- c(OL_list, (which(ldr7_cages$Animal_ID == this_weight & ldr7_cages[DV] == this_DV)))
}
print(OL_list)
#Assign list of outliers to specified variable lists (OL_list_EE_kJH, RQ, VO2, VCO2, mgH2O)
assign(paste("OL_list_", DV, sep = ""), OL_list)
}
masterlist <- c(OL_list_EE_kJH, OL_list_RQ, OL_list_VO2, OL_list_VCO2, OL_list_H2Omg, OL_list_Activity)
masterlist_noDup <- unique(masterlist)
lowfat_dehydration_noOL_rep7 <- ldr7_cages[-c(masterlist_noDup),]
lowfat_rep1_water_removal <- ymd_hms("2022-10-06 11:59:59", tz="EST")
baseline_lowfat_rep1 <- interval(lowfat_rep1_water_removal - days(3), lowfat_rep1_water_removal)
day1_lowfat_rep1 <- interval(lowfat_rep1_water_removal, lowfat_rep1_water_removal + days(1))
day2_lowfat_rep1 <- interval(lowfat_rep1_water_removal + days(1), lowfat_rep1_water_removal + days(2))
day3_lowfat_rep1 <- interval(lowfat_rep1_water_removal + days(2), lowfat_rep1_water_removal + days(3))
lowfat_rep2_water_removal <- ymd_hms("2022-10-30 11:59:59", tz="EST")
baseline_lowfat_rep2 <- interval(lowfat_rep2_water_removal - days(3), lowfat_rep2_water_removal)
day1_lowfat_rep2 <- interval(lowfat_rep2_water_removal, lowfat_rep2_water_removal + days(1))
day2_lowfat_rep2 <- interval(lowfat_rep2_water_removal + days(1), lowfat_rep2_water_removal + days(2))
day3_lowfat_rep2 <- interval(lowfat_rep2_water_removal + days(2), lowfat_rep2_water_removal + days(3))
lowfat_rep3_water_removal <- ymd_hms("2022-12-06 11:59:59", tz="EST")
baseline_lowfat_rep3 <- interval(lowfat_rep3_water_removal - days(3), lowfat_rep3_water_removal)
day1_lowfat_rep3 <- interval(lowfat_rep3_water_removal, lowfat_rep3_water_removal + days(1))
day2_lowfat_rep3 <- interval(lowfat_rep3_water_removal + days(1), lowfat_rep3_water_removal + days(2))
day3_lowfat_rep3 <- interval(lowfat_rep3_water_removal + days(2), lowfat_rep3_water_removal + days(3))
lowfat_rep4_water_removal <- ymd_hms("2023-01-09 11:59:59", tz="EST")
baseline_lowfat_rep4 <- interval(lowfat_rep4_water_removal - days(3), lowfat_rep4_water_removal)
day1_lowfat_rep4 <- interval(lowfat_rep4_water_removal, lowfat_rep4_water_removal + days(1))
day2_lowfat_rep4 <- interval(lowfat_rep4_water_removal + days(1), lowfat_rep4_water_removal + days(2))
day3_lowfat_rep4 <- interval(lowfat_rep4_water_removal + days(2), lowfat_rep4_water_removal + days(3))
lowfat_rep5_water_removal <- ymd_hms("2023-03-07 11:59:59", tz="EST")
baseline_lowfat_rep5 <- interval(lowfat_rep5_water_removal - days(1), lowfat_rep5_water_removal)
day1_lowfat_rep5 <- interval(lowfat_rep5_water_removal, lowfat_rep5_water_removal + days(1))
day2_lowfat_rep5 <- interval(lowfat_rep5_water_removal + days(1), lowfat_rep5_water_removal + days(2))
day3_lowfat_rep5 <- interval(lowfat_rep5_water_removal + days(2), lowfat_rep5_water_removal + days(3))
lowfat_rep6_water_removal <- ymd_hms("2023-03-23 11:59:59", tz="EST")
baseline_lowfat_rep6 <- interval(lowfat_rep6_water_removal - days(1), lowfat_rep6_water_removal)
day1_lowfat_rep6 <- interval(lowfat_rep6_water_removal, lowfat_rep6_water_removal + days(1))
day2_lowfat_rep6 <- interval(lowfat_rep6_water_removal + days(1), lowfat_rep6_water_removal + days(2))
day3_lowfat_rep6 <- interval(lowfat_rep6_water_removal + days(2), lowfat_rep6_water_removal + days(3))
lowfat_rep7_water_removal <- ymd_hms("2023-04-22 11:59:59", tz="EST")
baseline_lowfat_rep7 <- interval(lowfat_rep7_water_removal - days(1), lowfat_rep7_water_removal)
day1_lowfat_rep7 <- interval(lowfat_rep7_water_removal, lowfat_rep7_water_removal + days(1))
baseline_temp_lowfat_rep1 <- interval(lowfat_rep1_water_removal - days(30), lowfat_rep1_water_removal)
baseline_temp_lowfat_rep2 <- interval(lowfat_rep2_water_removal - days(30), lowfat_rep2_water_removal)
baseline_temp_lowfat_rep3 <- interval(lowfat_rep3_water_removal - days(3), lowfat_rep3_water_removal)
baseline_temp_lowfat_rep4 <- interval(lowfat_rep4_water_removal - days(3), lowfat_rep4_water_removal)
baseline_temp_lowfat_rep5 <- interval(lowfat_rep5_water_removal - days(1), lowfat_rep5_water_removal)
baseline_temp_lowfat_rep6 <- interval(lowfat_rep6_water_removal - days(1), lowfat_rep6_water_removal)
baseline_temp_lowfat_rep7 <- interval(lowfat_rep7_water_removal - days(1), lowfat_rep7_water_removal)
lowfat_dehydration_noOL_rep1 <- lowfat_dehydration_noOL_rep1 %>%
mutate(replicate = "rep1")
lowfat_dehydration_noOL_rep1 <- lowfat_dehydration_noOL_rep1 %>%
add_column(experiment_day = NA)
lowfat_dehydration_noOL_rep1$experiment_day[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_lowfat_rep1 == "TRUE"] <- "baseline"
lowfat_dehydration_noOL_rep1$experiment_day[lowfat_dehydration_noOL_rep1$DateTime %within% day1_lowfat_rep1 == "TRUE"] <- "day1"
lowfat_dehydration_noOL_rep1$experiment_day[lowfat_dehydration_noOL_rep1$DateTime %within% day2_lowfat_rep1 == "TRUE"] <- "day2"
lowfat_dehydration_noOL_rep1$experiment_day[lowfat_dehydration_noOL_rep1$DateTime %within% day3_lowfat_rep1 == "TRUE"] <- "day3"
write.csv(lowfat_dehydration_noOL_rep1, "lowfat_dehydration_rep1.csv", row.names = FALSE)
lowfat_dehydration_noOL_rep2 <- lowfat_dehydration_noOL_rep2 %>%
add_column(experiment_day = NA)
lowfat_dehydration_noOL_rep2 <- lowfat_dehydration_noOL_rep2 %>%
mutate(replicate = "rep2")
lowfat_dehydration_noOL_rep2$experiment_day[lowfat_dehydration_noOL_rep2$DateTime %within% baseline_lowfat_rep2 == "TRUE"] <- "baseline"
lowfat_dehydration_noOL_rep2$experiment_day[lowfat_dehydration_noOL_rep2$DateTime %within% day1_lowfat_rep2 == "TRUE"] <- "day1"
lowfat_dehydration_noOL_rep2$experiment_day[lowfat_dehydration_noOL_rep2$DateTime %within% day2_lowfat_rep2 == "TRUE"] <- "day2"
lowfat_dehydration_noOL_rep2$experiment_day[lowfat_dehydration_noOL_rep2$DateTime %within% day3_lowfat_rep2 == "TRUE"] <- "day3"
lowfat_dehydration_noOL_rep2a <- lowfat_dehydration_noOL_rep2
lowfat_dehydration_noOL_rep2b <- lowfat_dehydration_noOL_rep2
lowfat_dehydration_noOL_rep2c <- lowfat_dehydration_noOL_rep2
lowfat_dehydration_noOL_rep2 <- rbind(lowfat_dehydration_noOL_rep2a, lowfat_dehydration_noOL_rep2b, lowfat_dehydration_noOL_rep2c)
write.csv(lowfat_dehydration_noOL_rep2, "lowfat_dehydration_rep2.csv", row.names = FALSE)
lowfat_dehydration_noOL_rep3 <- lowfat_dehydration_noOL_rep3 %>%
add_column(experiment_day = NA)
lowfat_dehydration_noOL_rep3 <- lowfat_dehydration_noOL_rep3 %>%
mutate(replicate = "rep3")
lowfat_dehydration_noOL_rep3$experiment_day[lowfat_dehydration_noOL_rep3$DateTime %within% baseline_lowfat_rep3 == "TRUE"] <- "baseline"
lowfat_dehydration_noOL_rep3$experiment_day[lowfat_dehydration_noOL_rep3$DateTime %within% day1_lowfat_rep3 == "TRUE"] <- "day1"
lowfat_dehydration_noOL_rep3$experiment_day[lowfat_dehydration_noOL_rep3$DateTime %within% day2_lowfat_rep3 == "TRUE"] <- "day2"
lowfat_dehydration_noOL_rep3$experiment_day[lowfat_dehydration_noOL_rep3$DateTime %within% day3_lowfat_rep3 == "TRUE"] <- "day3"
lowfat_dehydration_noOL_rep3a <- lowfat_dehydration_noOL_rep3
lowfat_dehydration_noOL_rep3b <- lowfat_dehydration_noOL_rep3
lowfat_dehydration_noOL_rep3c <- lowfat_dehydration_noOL_rep3
lowfat_dehydration_noOL_rep3 <- rbind(lowfat_dehydration_noOL_rep3a, lowfat_dehydration_noOL_rep3b, lowfat_dehydration_noOL_rep3c)
write.csv(lowfat_dehydration_noOL_rep3, "lowfat_dehydration_rep3.csv", row.names = FALSE)
lowfat_dehydration_noOL_rep4 <- lowfat_dehydration_noOL_rep4 %>%
mutate(replicate = "rep4")
lowfat_dehydration_noOL_rep4 <- lowfat_dehydration_noOL_rep4 %>%
add_column(experiment_day = NA)
lowfat_dehydration_noOL_rep4$experiment_day[lowfat_dehydration_noOL_rep4$DateTime %within% baseline_lowfat_rep4 == "TRUE"] <- "baseline"
lowfat_dehydration_noOL_rep4$experiment_day[lowfat_dehydration_noOL_rep4$DateTime %within% day1_lowfat_rep4 == "TRUE"] <- "day1"
lowfat_dehydration_noOL_rep4$experiment_day[lowfat_dehydration_noOL_rep4$DateTime %within% day2_lowfat_rep4 == "TRUE"] <- "day2"
lowfat_dehydration_noOL_rep4$experiment_day[lowfat_dehydration_noOL_rep4$DateTime %within% day3_lowfat_rep4 == "TRUE"] <- "day3"
write.csv(lowfat_dehydration_noOL_rep4, "lowfat_dehydration_rep4.csv", row.names = FALSE)
lowfat_dehydration_noOL_rep5 <- lowfat_dehydration_noOL_rep5 %>%
mutate(replicate = "rep5")
lowfat_dehydration_noOL_rep5 <- lowfat_dehydration_noOL_rep5 %>%
add_column(experiment_day = NA)
lowfat_dehydration_noOL_rep5$experiment_day[lowfat_dehydration_noOL_rep5$DateTime %within% baseline_lowfat_rep5 == "TRUE"] <- "baseline"
lowfat_dehydration_noOL_rep5$experiment_day[lowfat_dehydration_noOL_rep5$DateTime %within% day1_lowfat_rep5 == "TRUE"] <- "day1"
lowfat_dehydration_noOL_rep5$experiment_day[lowfat_dehydration_noOL_rep5$DateTime %within% day2_lowfat_rep5 == "TRUE"] <- "day2"
lowfat_dehydration_noOL_rep5$experiment_day[lowfat_dehydration_noOL_rep5$DateTime %within% day3_lowfat_rep5 == "TRUE"] <- "day3"
write.csv(lowfat_dehydration_noOL_rep5, "lowfat_dehydration_rep5.csv", row.names = FALSE)
lowfat_dehydration_noOL_rep6 <- lowfat_dehydration_noOL_rep6 %>%
mutate(replicate = "rep6")
lowfat_dehydration_noOL_rep6 <- lowfat_dehydration_noOL_rep6 %>%
add_column(experiment_day = NA)
lowfat_dehydration_noOL_rep6$experiment_day[lowfat_dehydration_noOL_rep6$DateTime %within% baseline_lowfat_rep6 == "TRUE"] <- "baseline"
lowfat_dehydration_noOL_rep6$experiment_day[lowfat_dehydration_noOL_rep6$DateTime %within% day1_lowfat_rep6 == "TRUE"] <- "day1"
lowfat_dehydration_noOL_rep6$experiment_day[lowfat_dehydration_noOL_rep6$DateTime %within% day2_lowfat_rep6 == "TRUE"] <- "day2"
lowfat_dehydration_noOL_rep6$experiment_day[lowfat_dehydration_noOL_rep6$DateTime %within% day3_lowfat_rep6 == "TRUE"] <- "day3"
write.csv(lowfat_dehydration_noOL_rep6, "lowfat_dehydration_rep6.csv", row.names = FALSE)
lowfat_dehydration_noOL_rep7 <- lowfat_dehydration_noOL_rep7 %>%
mutate(replicate = "rep7")
lowfat_dehydration_noOL_rep7 <- lowfat_dehydration_noOL_rep7 %>%
add_column(experiment_day = NA)
lowfat_dehydration_noOL_rep7$experiment_day[lowfat_dehydration_noOL_rep7$DateTime %within% baseline_lowfat_rep7 == "TRUE"] <- "baseline"
lowfat_dehydration_noOL_rep7$experiment_day[lowfat_dehydration_noOL_rep7$DateTime %within% day1_lowfat_rep7 == "TRUE"] <- "day1"
write.csv(lowfat_dehydration_noOL_rep7, "lowfat_dehydration_rep7.csv", row.names = FALSE)
###### make data frames that contain all the data for a given interval.
lowfat_baseline_temps <-
rbind(#mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% baseline_temp_rep1,],
#mouse_metadata_rep2[mouse_metadata_rep2$DateTime %within% baseline_temp_rep2,],
ldr3_temps[ldr3_temps$DateTime %within% baseline_temp_lowfat_rep3,],
ldr4_temps[ldr4_temps$DateTime %within% baseline_temp_lowfat_rep4,],
ldr5_temps[ldr5_temps$DateTime %within% baseline_temp_lowfat_rep5,],
ldr6_temps[ldr6_temps$DateTime %within% baseline_temp_lowfat_rep6,],
ldr7_temps[ldr7_temps$DateTime %within% baseline_temp_lowfat_rep7,])
lowfat_day1_temps <-
rbind(#mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% day1_rep1,],
#mouse_metadata_rep2[mouse_metadata_rep2$DateTime %within% day1_rep2,],
ldr3_temps[ldr3_temps$DateTime %within% day1_lowfat_rep3,],
ldr4_temps[ldr4_temps$DateTime %within% day1_lowfat_rep4,],
ldr5_temps[ldr5_temps$DateTime %within% day1_lowfat_rep5,],
ldr6_temps[ldr6_temps$DateTime %within% day1_lowfat_rep6,],
ldr7_temps[ldr7_temps$DateTime %within% day1_lowfat_rep7,])
lowfat_day2_temps <-
rbind(#mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% day2_rep1,],
#mouse_metadata_rep2[mouse_metadata_rep2$DateTime %within% day2_rep2,],
ldr3_temps[ldr3_temps$DateTime %within% day2_lowfat_rep3,],
ldr4_temps[ldr4_temps$DateTime %within% day2_lowfat_rep4,],
ldr5_temps[ldr5_temps$DateTime %within% day2_lowfat_rep5,],
ldr6_temps[ldr6_temps$DateTime %within% day2_lowfat_rep6,])
lowfat_day3_temps <-
rbind(#mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% day3_rep1,],
#mouse_metadata_rep2[mouse_metadata_rep2$DateTime %within% day3_rep2,],
ldr3_temps[ldr3_temps$DateTime %within% day3_lowfat_rep3,],
ldr4_temps[ldr4_temps$DateTime %within% day3_lowfat_rep4,],
ldr5_temps[ldr5_temps$DateTime %within% day3_lowfat_rep5,],
ldr6_temps[ldr6_temps$DateTime %within% day3_lowfat_rep6,])
lowfat_baseline <-
rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_lowfat_rep1,],
lowfat_dehydration_noOL_rep2[lowfat_dehydration_noOL_rep2$DateTime %within% baseline_lowfat_rep2,],
lowfat_dehydration_noOL_rep3[lowfat_dehydration_noOL_rep3$DateTime %within% baseline_lowfat_rep3,],
lowfat_dehydration_noOL_rep4[lowfat_dehydration_noOL_rep4$DateTime %within% baseline_lowfat_rep4,],
lowfat_dehydration_noOL_rep5[lowfat_dehydration_noOL_rep5$DateTime %within% baseline_lowfat_rep5,],
lowfat_dehydration_noOL_rep6[lowfat_dehydration_noOL_rep6$DateTime %within% baseline_lowfat_rep6,],
lowfat_dehydration_noOL_rep7[lowfat_dehydration_noOL_rep7$DateTime %within% baseline_lowfat_rep7,])
lowfat_day1 <-
rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% day1_lowfat_rep1,],
lowfat_dehydration_noOL_rep2[lowfat_dehydration_noOL_rep2$DateTime %within% day1_lowfat_rep2,],
lowfat_dehydration_noOL_rep3[lowfat_dehydration_noOL_rep3$DateTime %within% day1_lowfat_rep3,],
lowfat_dehydration_noOL_rep4[lowfat_dehydration_noOL_rep4$DateTime %within% day1_lowfat_rep4,],
lowfat_dehydration_noOL_rep5[lowfat_dehydration_noOL_rep5$DateTime %within% day1_lowfat_rep5,],
lowfat_dehydration_noOL_rep6[lowfat_dehydration_noOL_rep6$DateTime %within% day1_lowfat_rep6,],
lowfat_dehydration_noOL_rep7[lowfat_dehydration_noOL_rep7$DateTime %within% day1_lowfat_rep7,])
lowfat_day2 <-
rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% day2_lowfat_rep1,],
lowfat_dehydration_noOL_rep2[lowfat_dehydration_noOL_rep2$DateTime %within% day2_lowfat_rep2,],
lowfat_dehydration_noOL_rep3[lowfat_dehydration_noOL_rep3$DateTime %within% day2_lowfat_rep3,],
lowfat_dehydration_noOL_rep4[lowfat_dehydration_noOL_rep4$DateTime %within% day2_lowfat_rep4,],
lowfat_dehydration_noOL_rep5[lowfat_dehydration_noOL_rep5$DateTime %within% day2_lowfat_rep5,],
lowfat_dehydration_noOL_rep6[lowfat_dehydration_noOL_rep6$DateTime %within% day2_lowfat_rep6,])
lowfat_day3 <-
rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% day3_lowfat_rep1,],
lowfat_dehydration_noOL_rep2[lowfat_dehydration_noOL_rep2$DateTime %within% day3_lowfat_rep2,],
lowfat_dehydration_noOL_rep3[lowfat_dehydration_noOL_rep3$DateTime %within% day3_lowfat_rep3,],
lowfat_dehydration_noOL_rep4[lowfat_dehydration_noOL_rep4$DateTime %within% day3_lowfat_rep4,],
lowfat_dehydration_noOL_rep5[lowfat_dehydration_noOL_rep5$DateTime %within% day3_lowfat_rep5,],
lowfat_dehydration_noOL_rep6[lowfat_dehydration_noOL_rep6$DateTime %within% day3_lowfat_rep6,])
all_lowfat_data <- rbind(lowfat_dehydration_noOL_rep1,lowfat_dehydration_noOL_rep2,         lowfat_dehydration_noOL_rep3,lowfat_dehydration_noOL_rep4,lowfat_dehydration_noOL_rep4,lowfat_dehydration_noOL_rep5,lowfat_dehydration_noOL_rep6,lowfat_dehydration_noOL_rep7)
all_lowfat_temps <- rbind(lowfat_baseline_temps,lowfat_day1_temps,lowfat_day2_temps,lowfat_day3_temps)
dim(ldr4_temps[ldr4_temps$DateTime %within% day3_lowfat_rep4,])
dim(ldr5_temps[ldr5_temps$DateTime %within% day3_lowfat_rep5,])
dim(ldr6_temps[ldr6_temps$DateTime %within% day3_lowfat_rep6,])
dim(lowfat_dehydration_noOL_rep5[lowfat_dehydration_noOL_rep5$DateTime %within% baseline_lowfat_rep5,])
dim(lowfat_dehydration_noOL_rep5[lowfat_dehydration_noOL_rep5$DateTime %within% day1_lowfat_rep5,])
dim(lowfat_dehydration_noOL_rep5[lowfat_dehydration_noOL_rep5$DateTime %within% day2_lowfat_rep5,])
dim(lowfat_dehydration_noOL_rep5[lowfat_dehydration_noOL_rep5$DateTime %within% day3_lowfat_rep5,])
dim(lowfat_dehydration_noOL_rep6[lowfat_dehydration_noOL_rep6$DateTime %within% baseline_lowfat_rep6,])
dim(lowfat_dehydration_noOL_rep6[lowfat_dehydration_noOL_rep6$DateTime %within% day1_lowfat_rep6,])
dim(lowfat_dehydration_noOL_rep6[lowfat_dehydration_noOL_rep6$DateTime %within% day2_lowfat_rep6,])
dim(lowfat_dehydration_noOL_rep6[lowfat_dehydration_noOL_rep6$DateTime %within% day3_lowfat_rep6,])
#I dont think this is needed.
#chunk5 <- chunk5 %>%
#  mutate(time = as.POSIXct(time, tz="EST", format = "%H:%M:%S")) %>%
#  mutate(hour = strftime(time, format="%H:%M:%S")) %>%
#  mutate(x_date = ymd_hms(paste("2022-10-25", hour)))
#probably don't need to do this every time, just in the beginning.
#I use this to identify animals whose body temps are really low - some of them are
#just like that, and others it's cause the tag has fallen out.
#I use the functions.r script to remove the animals whose tag has fallen out.
#of note, just becuase the tag has fallen out does not mean that the physiology data are bad.
lowfat_problems <- lowfat_day3_temps  %>% filter(body_temp < 26)
unique(lowfat_problems$Animal_ID)
#[1] "1118 good" "1145 good" "1228 bad" "1235 bad" "1197" "1144" "1131" "1184" "1219" "1265 bad?" "1233" "1245" "1181" "1212" "1260" "1232" "1254" "1191" "1183"
#[20] "1240" "1128" "1223"
#[1] "1197" "1145" "1240" "1245" "1191"
#[1] "1240" "1197" "1245" "1191"
problem_animal <- 1245
coeff <- 0
cols <- c("Baseline"="navyblue","Day 1"="sienna1","Day 2"="sienna3", "Day 3"="sienna4")
prob_temp <- ggplot(data = lowfat_baseline_temps %>% filter(Animal_ID == problem_animal) ,aes(x=as.POSIXct(time),y=body_temp)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.1), shape=20, size=1)+
geom_point(data = lowfat_day1_temps %>% filter(Animal_ID == problem_animal), aes(color="Day 1", alpha=0.2), shape=20, size=1)+
geom_point(data = lowfat_day2_temps %>% filter(Animal_ID == problem_animal), aes(color="Day 2", alpha=0.2), shape=20, size=1)+
geom_point(data = lowfat_day3_temps %>% filter(Animal_ID == problem_animal)%>% filter(Animal_ID == "1137"), aes(color="Day 3", alpha=0.2), shape=20, size=1)+
theme_classic()+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (°C)", limits = c(20,40), sec.axis = sec_axis(~. - coeff, name="Room Temperature (°C)"))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
prob_temp
coeff <- 0
cols <- c("Baseline"="navyblue","Day 1"="sienna1","Day 2"="sienna3", "Day 3"="sienna4")
lowfat_temperatures <- ggplot(data = lowfat_baseline_temps ,aes(x=as.POSIXct(time),y=body_temp)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.1), shape=20, size=0.5)+
geom_point(data = lowfat_day1_temps, aes(color="Day 1", alpha=0.2), shape=20, size=0.5)+
geom_point(data = lowfat_day2_temps, aes(color="Day 2", alpha=0.2), shape=20, size=0.5)+
geom_point(data = lowfat_day3_temps, aes(color="Day 3", alpha=0.2), shape=20, size=0.5)+
geom_point(data = chunk1, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
theme_classic()+
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"), span=0.2, size=2)+
geom_smooth(data = lowfat_day1_temps, method='gam', se = FALSE, aes(color = "Day 1"), size=2)+
geom_smooth(data = lowfat_day2_temps, method='gam', se = FALSE, aes(color = "Day 2"), size=2)+
geom_smooth(data = lowfat_day3_temps, method='gam', se = FALSE, aes(color = "Day 3"), size=2)+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (°C)", limits = c(20,40), sec.axis = sec_axis(~. - coeff, name="Room Temperature (°C)"))+
guides(alpha = "none")+
facet_wrap(~sex) +
scale_colour_manual(name="Dehydration",values=cols, guide="none")
lowfat_temperatures
library(plotly)
ggplotly(lowfat_temperatures)
view(lowfat_day3_temps)
library(devtools)
library(tidyverse)
library(lubridate)
library(readr)
library(viridis)
library(patchwork)
library(tidyselect)
library(readxl)
library(broom)
library(cowplot)
library(DescTools)
library(ggpubr)
library(plyr)
library(pwr)
library(Cairo)
library(ggpattern)
library(timeDate)
library(mgcv)
library(MASS)
library(dplyr)
setwd("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/R/lowfat_dehydration/")
path <- "C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep1/"
source("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/R/functions.R")
mouse_metadata_rep1 <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep1/mouse_data_rep1.csv",skip_empty_rows=TRUE) %>%
mutate(date, date = as.Date(date, format = "%d-%m-%y", tz="EST")) %>%
unite("DateTime", date:time, remove = FALSE, sep =  " ") %>%
mutate(DateTime = as.POSIXlt(DateTime), tz="EST")
mouse_metadata_rep2 <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep2/lowfat_dehydration_temps_rep2.csv",skip_empty_rows=TRUE) %>%
mutate(date, date = as.Date(date, format = "%d-%m-%y", tz="EST")) %>%
unite("DateTime", date:time, remove = FALSE, sep =  " ") %>%
mutate(DateTime = as.POSIXlt(DateTime), tz="EST")
mouse_metadata_rep3 <- read_excel("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/mouse_data.xlsx",
sheet = "lowfat_rep3_new", col_types = c("text",
"numeric", "numeric", "text", "text",
"numeric", "text", "text", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "text"))
library(devtools)
library(tidyverse)
library(lubridate)
library(readr)
library(viridis)
library(patchwork)
library(tidyselect)
library(readxl)
library(broom)
library(cowplot)
library(DescTools)
library(ggpubr)
library(plyr)
library(pwr)
library(Cairo)
library(ggpattern)
library(timeDate)
library(mgcv)
library(MASS)
library(dplyr)
setwd("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/R/lowfat_dehydration/")
path <- "C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep1/"
source("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/R/functions.R")
mouse_metadata_rep1 <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep1/mouse_data_rep1.csv",skip_empty_rows=TRUE) %>%
mutate(date, date = as.Date(date, format = "%d-%m-%y", tz="EST")) %>%
unite("DateTime", date:time, remove = FALSE, sep =  " ") %>%
mutate(DateTime = as.POSIXlt(DateTime), tz="EST")
mouse_metadata_rep2 <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep2/lowfat_dehydration_temps_rep2.csv",skip_empty_rows=TRUE) %>%
mutate(date, date = as.Date(date, format = "%d-%m-%y", tz="EST")) %>%
unite("DateTime", date:time, remove = FALSE, sep =  " ") %>%
mutate(DateTime = as.POSIXlt(DateTime), tz="EST")
mouse_metadata_rep3 <- read_excel("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/mouse_data.xlsx",
sheet = "lowfat_rep3_new", col_types = c("text",
"numeric", "numeric", "text", "text",
"numeric", "text", "text", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "text"))
mouse_metadata_lowfat_rep4 <- read_excel("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/mouse_data.xlsx",
sheet = "rep4_lowfat", col_types = c("text",
"numeric", "numeric", "text", "text",
"numeric", "text", "text", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "text"))
mouse_metadata_lowfat_rep5 <- read_excel("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/mouse_data.xlsx",
sheet = "rep5_lowfat", col_types = c("text",
"numeric", "numeric", "text", "text",
"numeric", "text", "text", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "text"))
mouse_metadata_lowfat_rep6 <- read_excel("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/mouse_data.xlsx",
sheet = "rep6_lowfat", col_types = c("text",
"numeric", "numeric", "text", "text",
"numeric", "text", "text", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "text"))
mouse_metadata_lowfat_rep7 <- read_excel("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/mouse_data.xlsx",
sheet = "rep7_lowfat", col_types = c("text",
"numeric", "numeric", "text", "text",
"numeric", "text", "text", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "text"))
#this is the baseline part of rep1
path <- "C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep1/"
chunk5 <- bring_in_data_rep1("chunk5.csv")
